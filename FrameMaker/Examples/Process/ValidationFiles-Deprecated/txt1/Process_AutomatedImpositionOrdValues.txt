/*
* calculates a "real" ord value in an automated layout
* 
* @param ord the Value of Ord in the layout
* @param nPages the total number of pages that are consumed by the Layout, if    
*    frontOffset!=0 the pages before frontOffset are NOT counted
* @param loop which sheet loop are we on?
* @param maxOrdFront number of pages consumed from the front of the list
* @param maxOrdBack positive number of pages consumed from the back of the list
* @param frontOffset page number of the first page to be placed on ord 0 in loop 0
* @return the pge to assign in this Ord, -1 if no page fits
*/

public static int calcOrd(int ord, int nPages, int loop, int maxOrdFront, 
		int maxOrdBack, int frontOffset){
	final int maxOrd = maxOrdFront + maxOrdBack;
	if(maxOrd*loop >= nPages){
		return -1; // we are in a loop that has no remaining pages
	}
	int page;
	if(ord >= 0){ // count from front
		page = ord + loop*maxOrdFront;
	} else { // the page to put on -1
		int end = nPages + maxOrd - 1 -((nPages +maxOrd - 1)%maxOrd);
		page = end - loop*maxOrdBack+ord;
	}
	// if a page evaluates to e.g. 10 and we only have 9 pages, ciao
	return page< nPages? page+frontOffset : -1;
}
